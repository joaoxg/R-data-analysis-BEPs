<<<<<<< HEAD
## Add to playerround the player code to filter datasets per player by playerround = player id
playerround <- playerround %>%
inner_join(player %>% select(id, code), by = c("player_id" = "id"))
## Sort per welfaretype (ascending)
welfaretype <- arrange(welfaretype, round_income)
# # 3. Filter the playerround dataset for the income distribution  --------
## variables selection for the income distribution plot
income_dist_var <- c("id", "player_id","code", "groupround_id", "round_number",
"round_income", "living_costs", "paid_debt",
"profit_sold_house","spent_savings_for_buying_house",
"cost_taxes", "mortgage_payment",
"cost_measures_bought", "cost_satisfaction_bought",
"cost_fluvial_damage", "cost_pluvial_damage",
"spendable_income"
)
## Select those columns from the playerround
income_dist <- playerround %>% select(all_of(income_dist_var))
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
gamesession <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gamesession.csv"))
group <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "group.csv"))
groupround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "groupround.csv"))
playerround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "playerround.csv"))
welfaretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "welfaretype.csv"))
scenario <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "scenario.csv"))
player <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "player.csv"))
housemeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housemeasure.csv"))
housegroup <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housegroup.csv"))
measuretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "measuretype.csv"))
personalmeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "personalmeasure.csv"))
# # 2. Add the variables to plot per session, group and player ------------
# Add the session name variable remaned to avoid name overlap with the group name variable
gamesession <- gamesession %>% rename(gamesession_name = name)
# Add to group the gamesession_name
# Merge the gamesession selection into the group by the group = gamesession id
# Inner_join keeps only the rows that have matching values in both data frames
group <- group %>%
inner_join(gamesession %>% select(id, gamesession_name), by = c("gamesession_id" = "id"))
# Add to groupround the group_name and gamesession_name
## Merge the group selection into the groupround by the groupround = group id
groupround <- groupround %>%
inner_join(group %>% select(id, name, gamesession_id, gamesession_name, scenario_id), by = c("group_id" = "id"))
## Rename name variable in groupround for variable naming consistency
groupround <- groupround %>% rename(group_name = name)
## Add to playerround the groupround selection to filter per round, group and session id and names by playerround = groupround id
playerround <- playerround %>%
inner_join(groupround %>% select(id, round_number, group_id, group_name, gamesession_id, gamesession_name, scenario_id), by = c("groupround_id" = "id"))
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
gamesession <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gamesession.csv"))
group <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "group.csv"))
groupround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "groupround.csv"))
playerround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "playerround.csv"))
welfaretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "welfaretype.csv"))
scenario <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "scenario.csv"))
player <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "player.csv"))
housemeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housemeasure.csv"))
housegroup <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housegroup.csv"))
measuretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "measuretype.csv"))
personalmeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "personalmeasure.csv"))
# # 2. Add the variables to plot per session, group and player ------------
# Add the session name variable remaned to avoid name overlap with the group name variable
gamesession <- gamesession %>% rename(gamesession_name = name)
# Add to group the gamesession_name
# Merge the gamesession selection into the group by the group = gamesession id
# Inner_join keeps only the rows that have matching values in both data frames
group <- group %>%
inner_join(gamesession %>% select(id, gamesession_name), by = c("gamesession_id" = "id"))
# Add to groupround the group_name and gamesession_name
## Merge the group selection into the groupround by the groupround = group id
groupround <- groupround %>%
inner_join(group %>% select(id, name, gamesession_id, gamesession_name, scenario_id), by = c("group_id" = "id"))
## Rename name variable in groupround for variable naming consistency
groupround <- groupround %>% rename(group_name = name)
## Add to playerround the groupround selection to filter per round, group and session id and names by playerround = groupround id
playerround <- playerround %>%
inner_join(groupround %>% select(id, round_number, group_id, group_name, gamesession_id, gamesession_name, scenario_id), by = c("groupround_id" = "id"))
## Add to playerround the player code to filter datasets per player by playerround = player id
playerround <- playerround %>%
inner_join(player %>% select(id, code), by = c("player_id" = "id"))
View(playerround)
View(playerround)
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
gamesession <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gamesession.csv"))
group <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "group.csv"))
groupround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "groupround.csv"))
playerround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "playerround.csv"))
welfaretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "welfaretype.csv"))
scenario <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "scenario.csv"))
player <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "player.csv"))
housemeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housemeasure.csv"))
housegroup <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housegroup.csv"))
measuretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "measuretype.csv"))
personalmeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "personalmeasure.csv"))
# # 2. Add the variables to plot per session, group and player ------------
# Add the session name variable remaned to avoid name overlap with the group name variable
gamesession <- gamesession %>% rename(gamesession_name = name)
# Add to group the gamesession_name
# Merge the gamesession selection into the group by the group = gamesession id
# Inner_join keeps only the rows that have matching values in both data frames
group <- group %>%
inner_join(gamesession %>% select(id, gamesession_name), by = c("gamesession_id" = "id"))
# Add to groupround the group_name and gamesession_name
## Merge the group selection into the groupround by the groupround = group id
groupround <- groupround %>%
inner_join(group %>% select(id, name, gamesession_id, gamesession_name, scenario_id), by = c("group_id" = "id"))
## Rename name variable in groupround for variable naming consistency
groupround <- groupround %>% rename(group_name = name)
## Add to playerround the groupround selection to filter per round, group and session id and names by playerround = groupround id
playerround <- playerround %>%
inner_join(groupround %>% select(id, round_number, group_id, group_name, gamesession_id, gamesession_name, scenario_id), by = c("groupround_id" = "id"))
## Add to playerround the player code to filter datasets per player by playerround = player id
playerround <- playerround %>%
inner_join(player %>% select(id, code), by = c("player_id" = "id"))
View(playerround)
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
gamesession <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gamesession.csv"))
group <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "group.csv"))
groupround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "groupround.csv"))
playerround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "playerround.csv"))
welfaretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "welfaretype.csv"))
scenario <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "scenario.csv"))
player <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "player.csv"))
housemeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housemeasure.csv"))
housegroup <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housegroup.csv"))
measuretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "measuretype.csv"))
personalmeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "personalmeasure.csv"))
# # 2. Add the variables to plot per session, group and player ------------
# Add the session name variable remaned to avoid name overlap with the group name variable
gamesession <- gamesession %>% rename(gamesession_name = name)
View(gamesession)
View(welfaretype)
View(welfaretype)
View(gamesession)
View(gamesession)
View(gamesession)
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
# gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
# gamesession <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gamesession.csv"))
# group <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "group.csv"))
# groupround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "groupround.csv"))
# playerround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "playerround.csv"))
# welfaretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "welfaretype.csv"))
# scenario <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "scenario.csv"))
# player <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "player.csv"))
# housemeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housemeasure.csv"))
# housegroup <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housegroup.csv"))
# measuretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "measuretype.csv"))
# personalmeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "personalmeasure.csv"))
#
# # # 2. Add the variables to plot per session, group and player ------------
# # Add the session name variable remaned to avoid name overlap with the group name variable
# gamesession <- gamesession %>% rename(gamesession_name = name)
#
# # Add to group the gamesession_name
# # Merge the gamesession selection into the group by the group = gamesession id
# # Inner_join keeps only the rows that have matching values in both data frames
# group <- group %>%
#   inner_join(gamesession %>% select(id, gamesession_name), by = c("gamesession_id" = "id"))
#
# # Add to groupround the group_name and gamesession_name
# ## Merge the group selection into the groupround by the groupround = group id
# groupround <- groupround %>%
#   inner_join(group %>% select(id, name, gamesession_id, gamesession_name, scenario_id), by = c("group_id" = "id"))
# ## Rename name variable in groupround for variable naming consistency
# groupround <- groupround %>% rename(group_name = name)
#
# ## Add to playerround the groupround selection to filter per round, group and session id and names by playerround = groupround id
# playerround <- playerround %>%
#   inner_join(groupround %>% select(id, round_number, group_id, group_name, gamesession_id, gamesession_name, scenario_id), by = c("groupround_id" = "id"))
#
# ## Add to playerround the player code to filter datasets per player by playerround = player id
# playerround <- playerround %>%
#   inner_join(player %>% select(id, code), by = c("player_id" = "id"))
rstudioapi::isAvailable()
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
# gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
# gamesession <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gamesession.csv"))
# group <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "group.csv"))
# groupround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "groupround.csv"))
# playerround <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "playerround.csv"))
# welfaretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "welfaretype.csv"))
# scenario <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "scenario.csv"))
# player <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "player.csv"))
# housemeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housemeasure.csv"))
# housegroup <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "housegroup.csv"))
# measuretype <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "measuretype.csv"))
# personalmeasure <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "personalmeasure.csv"))
#
# # # 2. Add the variables to plot per session, group and player ------------
# # Add the session name variable remaned to avoid name overlap with the group name variable
# gamesession <- gamesession %>% rename(gamesession_name = name)
#
# # Add to group the gamesession_name
# # Merge the gamesession selection into the group by the group = gamesession id
# # Inner_join keeps only the rows that have matching values in both data frames
# group <- group %>%
#   inner_join(gamesession %>% select(id, gamesession_name), by = c("gamesession_id" = "id"))
#
# # Add to groupround the group_name and gamesession_name
# ## Merge the group selection into the groupround by the groupround = group id
# groupround <- groupround %>%
#   inner_join(group %>% select(id, name, gamesession_id, gamesession_name, scenario_id), by = c("group_id" = "id"))
# ## Rename name variable in groupround for variable naming consistency
# groupround <- groupround %>% rename(group_name = name)
#
# ## Add to playerround the groupround selection to filter per round, group and session id and names by playerround = groupround id
# playerround <- playerround %>%
#   inner_join(groupround %>% select(id, round_number, group_id, group_name, gamesession_id, gamesession_name, scenario_id), by = c("groupround_id" = "id"))
#
# ## Add to playerround the player code to filter datasets per player by playerround = player id
# playerround <- playerround %>%
#   inner_join(player %>% select(id, code), by = c("player_id" = "id"))
View(gameversion)
View(gameversion)
("SELECT name FROM gameversion WHERE id = 13")
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
result <- sqldf("SELECT name FROM gameversion WHERE id = 13")
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
gameversion <- read_csv(paste0(script_dir, "\\",folder_name, "\\", "gameversion.csv"))
result <- sqldf("SELECT name FROM gameversion WHERE id = 13")
View(result)
View(result)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
print(folder_path)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
# List all CSV files in the folder
csv_data_list <- lapply(csv_files, read_csv)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
# List all CSV files in the folder
csv_data_list <- lapply(csv_files, read_csv)
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
# List all CSV files in the folder
csv_files <- list.files(path = folder_path, pattern = "\\.csv$", full.names = TRUE)
# List all CSV files in the folder
csv_data_list <- lapply(csv_files, read_csv)
# Optionally, name each list element by its file name (without extension)
names(csv_data_list) <- tools::file_path_sans_ext(basename(csv_files))
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
# List all CSV files in the folder
csv_files <- list.files(path = folder_path, pattern = "\\.csv$", full.names = TRUE)
# List all CSV files in the folder
csv_data_list <- lapply(csv_files, read_csv)
# Optionally, name each list element by its file name (without extension)
names(csv_data_list) <- tools::file_path_sans_ext(basename(csv_files))
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# # 1. Read the database folder to create accordingly the dataframes -----------
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
# List all CSV files in the folder
csv_files <- list.files(path = folder_path, pattern = "\\.csv$", full.names = TRUE)
# List all CSV files in the folder
csv_data_list <- lapply(csv_files, read_csv)
# Optionally, name each list element by its file name (without extension)
names(csv_data_list) <- tools::file_path_sans_ext(basename(csv_files))
# Load necessary libraries
library(readxl)
library(readr)
# Load if using RStudio (interactive session)
library(rstudioapi)
library(sqldf)
# Get the path of the current script (works in RStudio)
folder_name <- "housinggame_session_20_251007_VerzekeraarsMasterClass"
script_path <- rstudioapi::getActiveDocumentContext()$path
script_dir <- dirname(script_path)
# Set folder path dynamically
folder_path <- paste0(script_dir, "\\",folder_name)
# List all CSV files in the folder
csv_files <- list.files(path = folder_path, pattern = "\\.csv$", full.names = TRUE)
# Read all CSVs into a list
csv_data_list <- lapply(csv_files, read_csv)
# Optionally, name each list element by its file name (without extension)
names(csv_data_list) <- tools::file_path_sans_ext(basename(csv_files))
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source('~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R')
source('~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R')
source('~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R')
source('~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R')
source('~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R')
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files_function_vjcortesa.R")
View(read_all_csvs)
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
View(read_all_csvs)
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files_function_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/Read_dataset_files.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/WWM_How did players spend their money_vjcortesa.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis_24 dataset/250814_Ommen session_240924.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis_24 dataset/250814_Ommen session_240924.R")
# Load necessary libraries
library(readxl)
source("~/TUDelft/18_Notebooks_071125/R data analysis_24 dataset/250814_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks_071125/R data analysis_24 dataset/250814_Ommen session_240924.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GS4_vjcortesa_How is risk perception assessed_risk profiles.R")
# Step 1: Installing and Load the required Packages ------------------------------------------------------------------
# Install, load, set the necessary packages, directories and functions
library(readxl)
# Load if using RStudio (interactive session)
library(rstudioapi)
# Managing datasets
library(dplyr)
# Load for excel manipulation
library(writexl)
# Load for the latentclass analysis
library(poLCA)
# run melt function
library(reshape2)
# plot
library(ggplot2)
# Get the path of the current script (works in RStudio)
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DataSettings.R"
script_path <- rstudioapi::getActiveDocumentContext()$path
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/"
scriptfolder_path <- dirname(script_path)
setwd(scriptfolder_path)
getwd()
# Set path to shared folder with the rawdata two directories up
datasetfolder_path <- file.path(dirname(getwd()),"Datasets")
##Added
# Set path to the output directories
dataoutput_dir <- file.path("data_output", "GS4_25-24_presurveys")
figoutput_dir <- file.path("fig_output", "GS4_25-24_presurveys")
# Create the subfolder if it doesn't exist
dir.create(dataoutput_dir, showWarnings = FALSE, recursive = TRUE)
dir.create(figoutput_dir, showWarnings = FALSE, recursive = TRUE)
github <- "vjcortesa"
##End added
# Load required functions
source(file.path("functions", "vjcortesa_RiskPerception_DS_function.R"))
# Step 2: Data Preparation ------------------------------------------------------------------
# Set paths to datasets
presurvey_overview <- file.path(datasetfolder_path,"vjcortesa_Presurvey_questions overview.xlsx")
presurvey_settings_240924 <- read_excel(presurvey_overview, sheet = "dataset_240924")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GS4_vjcortesa_How is risk perception assessed_risk profiles.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GS4_vjcortesa_How is risk perception assessed_risk profiles.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DS.R")
=======
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Round Spendable \n Income",
values = c(
"ave_Spendable" = "black"),
labels = c(
"ave_Spendable" = "Round income - costs")
) +
scale_fill_manual(
name = "Round costs",
values = c(
"ave_income_minus_living" = "#E1BB70",
"ave_debt" = "black",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "white",
"ave_profit_minus_spent_savings_house_moving" =  "#a3a3a3",
"ave_mortgage" = "#cccccc",
"ave_taxes" = "#dddddd",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"),
labels = c(
"ave_income_minus_living" = "Income - Living costs",
"ave_debt" = "Debt",
"ave_satisfaction" = "Satisfaction",
"ave_measures" = "Measures",
"ave_mortgage" = "Mortgage",
"ave_profit_minus_spent_savings_house_moving" = "House profit - Spent savings",
"ave_taxes" = "Taxes",
"ave_fluvial_damage" = "River damage",
"ave_pluvial_damage" = "Rain damage")
) +
guides(
fill = guide_legend(title = "Round costs"),
color = guide_legend(title = "Round Spendable Income")
) +
#Y-axis formatting
scale_y_continuous(
labels = function(y) y / 1000,
name = "Game Currency (k)"
) +
scale_x_continuous(
name = "Round income (k) \n Players per class",
breaks = c(1, 2, 3, 4, 5, 6),
labels = income_dist_x$label
) +
theme_minimal() +
theme(
axis.text.x = element_markdown(angle = 0, hjust = 0.5), ##takes rich html
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, size = 10),
plot.title.position = "plot"
)
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
plot <- ggplot() +
geom_area(data = area_income_formatted,
aes(x = Index, y = Value, fill = Type),
alpha = 0.6
) +
geom_bar(data = bars_expenses_formatted,
aes(x = Index, y = Value, fill = Type),
stat = "identity",
position = "stack",
width = w
) +
geom_line(
data = line_spendable,
aes(x = Index,
y = ave_Spendable,
color = "ave_Spendable"),
linewidth = 1.2) +
labs(
title = plot_title,
subtitle = plot_subtitle,
color = "Category"
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Round Spendable \n Income",
values = c(
"ave_Spendable" = "black"),
labels = c(
"ave_Spendable" = "Round income - costs")
) +
scale_fill_manual(
name = "Round costs",
values = c(
"ave_income_minus_living" = "#E1BB70",
"ave_debt" = "black",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "white",
"ave_profit_minus_spent_savings_house_moving" =  "#a3a3a3",
"ave_mortgage" = "#cccccc",
"ave_taxes" = "#dddddd",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"),
labels = c(
"ave_income_minus_living" = "Income - Living costs",
"ave_debt" = "Debt",
"ave_satisfaction" = "Satisfaction",
"ave_measures" = "Measures",
"ave_mortgage" = "Mortgage",
"ave_profit_minus_spent_savings_house_moving" = "House profit - Spent savings",
"ave_taxes" = "Taxes",
"ave_fluvial_damage" = "River damage",
"ave_pluvial_damage" = "Rain damage")
) +
guides(
fill = guide_legend(title = "Round costs"),
color = guide_legend(title = "Round Spendable Income")
) +
#Y-axis formatting
scale_y_continuous(
labels = function(y) y / 1000,
name = "Game Currency (k)"
) +
scale_x_continuous(
name = "Round income (k) \n Players per class",
breaks = c(1, 2, 3, 4, 5, 6),
labels = income_dist_x$label
) +
theme_minimal() +
theme(
axis.text.x = element_markdown(angle = 0, hjust = 0.5), ##takes rich html
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, size = 10),
plot.title.position = "plot"
)
ggsave(plot_name, width = 12, height = 6, dpi = 300)
plot(plot)
print(getwd())
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
print(script_path)
script_path <- dirname(rstudioapi::getActiveDocumentContext()$path)
function_path <- file.path(script_path,"functions")
dataset_path <- file.path(dirname(script_path),"Datasets")
data_output_path <- file.path(script_path,"data_output")
fig_output_path <- file.path(script_path,"fig_output")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
ggsave(
file.path(data_output_path,"myplot.png"),
plot = plot,
width = 12,
height = 6,
dpi = 300)
plot(plot)
print(plot_name)
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
ggsave(
file.path(fig_output_path,"myplot.png"),
plot = plot,
width = 12,
height = 6,
dpi = 300)
print(plot_name)
ggsave(
file.path(fig_output_path,plot_name),
plot = plot,
width = 12,
height = 6,
dpi = 300)
View(gamesession)
dataset_name <- str_extract(folder_name, "\\d+")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
View(fdataset)
View(fdataset)
View(fdataset)
View(gamesession)
print(gamesession$gamesession_name)
dataset_name <- str_extract(gamesession$gamesession_name, "\\d+")
print(gamesession$gamesession_name)
print(dataset_name)
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_How did players spend their money_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_How did players spend their money_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_How did players spend their money_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
# Write to Excel with sheet names matching table names
write_xlsx(list_income_dist, "folder_name_income_dist.xlsx")
tryCatch({
write_xlsx(list_income_dist, file.path(data_output_path, paste0("Income_dist_", folder_name, ".xlsx")))
message("File written successfully.")
}, error = function(e) {
message("Error: ", e$message)
})
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP2_vjcortesa_check errors.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GP3_vjcortesa_Selected measures.R")
images_list <- lapply(seq_len(nrow(icon_map)), function(i) {
list(
source   = icon_map$src[i],
xref     = "x", yref = "y",
x        = x_off,
y        = as.character(icon_map$label[i]),  # <-- anchor to label values
sizex    = 0.08 * x_max,
sizey    = 0.8,
xanchor  = "left",
yanchor  = "middle",
layer    = "above"
)
})
p <- layout(p, images = images_list)
p
# Step 1: Installing and Load the required Packages ------------------------------------------------------------------
# Install, load, set the necessary packages, directories and functions
library(readxl)
# Load if using RStudio (interactive session)
library(rstudioapi)
# Managing datasets
library(dplyr)
# Load for excel manipulation
library(writexl)
# Load for the latentclass analysis
library(poLCA)
# run melt function
library(reshape2)
# plot
library(ggplot2)
# Get the path of the current script (works in RStudio)
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DataSettings.R"
script_path <- rstudioapi::getActiveDocumentContext()$path
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/"
scriptfolder_path <- dirname(script_path)
setwd(scriptfolder_path)
getwd()
# Set path to shared folder with the rawdata two directories up
datasetfolder_path <- file.path(dirname(getwd()),"Datasets")
##Added
# Set path to the output directories
dataoutput_dir <- file.path("data_output", "GS4_25-24_presurveys")
figoutput_dir <- file.path("fig_output", "GS4_25-24_presurveys")
# Create the subfolder if it doesn't exist
dir.create(dataoutput_dir, showWarnings = FALSE, recursive = TRUE)
dir.create(figoutput_dir, showWarnings = FALSE, recursive = TRUE)
github <- "vjcortesa"
##End added
source(file.path("functions", "vjcortesa_RiskPerception_DS_function.R"))
presurvey_overview <- file.path(datasetfolder_path,"vjcortesa_Presurvey_questions overview.xlsx")
presurvey_settings_240924 <- read_excel(presurvey_overview, sheet = "dataset_240924")
presurvey_file_240924 <- file.path(datasetfolder_path,"housinggame_session_16_240924_surveys/241108_240924_WhereWeMove sessions - presurvey.xlsx")
View(presurvey_settings_240924)
presurvey_settings_250923 <- read_excel(presurvey_overview, sheet = "dataset_250923")
presurvey_file_250923 <- file.path(datasetfolder_path,"housinggame_session_19_250923_surveys/251119_250923_WhereWeMove sessions - presurvey.xlsx")
presurvey_settings_251007 <- read_excel(presurvey_overview, sheet = "dataset_251007")
presurvey_file_251007 <- file.path(datasetfolder_path,"housinggame_session_20_251007_surveys/251009_251007_WhereWeMove sessions - presurvey.xlsx")
# Get the path of the current script (works in RStudio)
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DataSettings.R"
function_path <- rstudioapi::getActiveDocumentContext()$path
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/"
functionfolder_path <- dirname(function_path)
# Set path to shared folder with the rawdata two directories up
datasetfolder_path <- paste0(dirname(dirname(functionfolder_path)),"/Datasets/")
# Allow to set and check working space for the github collaborator coding
setwd(functionfolder_path)
getwd()
dir()
# Step 1: Read the full sheet including metadata
raw_data <- read_excel(presurvey_path, col_names = FALSE)
# Set paths to datasets
presurvey_overview <- paste0(datasetfolder_path,"vjcortesa_Presurvey_questions overview.xlsx")
presurvey_settings <- read_excel(presurvey_overview, sheet = "dataset_240924")
presurvey_path <- paste0(datasetfolder_path,"housinggame_session_16_240924_surveys/241108_240924_WhereWeMove sessions - presurvey.xlsx")
# Step 1: Read the full sheet including metadata
raw_data <- read_excel(presurvey_path, col_names = FALSE)
# Step 2: Extract the actual headers from row 2
real_headers <- as.character(unlist(raw_data[2, ]))
# Step 2: Extract the actual headers from row 2
real_headers <- as.character(unlist(raw_data[2, ]))
# Step 3: Read the data again, skipping metadata rows (e.g., first 2 rows)
presurvey_data <- read_excel(presurvey_path, skip = 3, col_names = FALSE)
View(presurvey_data)
# Step 4: Assign the real headers
colnames(presurvey_data) <- real_headers
View(presurvey_data)
presurvey_settings_rp <- presurvey_settings %>%
filter(!is.na(DataAnalysisQuestion) & DataAnalysisQuestion != 0)
presurvey_settings_rp <- presurvey_settings %>%
filter(!is.na(DataAnalysisQuestion) & DataAnalysisQuestion != 0)
View(presurvey_settings_rp)
# Step 1: Data Settings ------------------------------------------------------------------
# Install, load, set the necessary packages, directories and functions
library(readxl)
# Load if using RStudio (interactive session)
library(rstudioapi)
# Managing datasets
library(dplyr)
# Load for excel manipulation
library(writexl)
# Get the path of the current script (works in RStudio)
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DataSettings.R"
function_path <- rstudioapi::getActiveDocumentContext()$path
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/"
functionfolder_path <- dirname(function_path)
# Set path to shared folder with the rawdata two directories up
datasetfolder_path <- paste0(dirname(dirname(functionfolder_path)),"/Datasets/")
# Allow to set and check working space for the github collaborator coding
setwd(functionfolder_path)
getwd()
dir()
# Set paths to datasets
presurvey_overview <- paste0(datasetfolder_path,"vjcortesa_Presurvey_questions overview.xlsx")
presurvey_settings <- read_excel(presurvey_overview, sheet = "dataset_240924")
presurvey_path <- paste0(datasetfolder_path,"housinggame_session_16_240924_surveys/241108_240924_WhereWeMove sessions - presurvey.xlsx")
# Step 1: Read the full sheet including metadata
raw_data <- read_excel(presurvey_path, col_names = FALSE)
# Step 2: Extract the actual headers from row 2
real_headers <- as.character(unlist(raw_data[2, ]))
# Step 3: Read the data again, skipping metadata rows (e.g., first 2 rows)
presurvey_data <- read_excel(presurvey_path, skip = 3, col_names = FALSE)
# Step 4: Assign the real headers
colnames(presurvey_data) <- real_headers
presurvey_settings_rp <- presurvey_settings %>%
filter(!is.na(DataAnalysisQuestion) & DataAnalysisQuestion != 0)
# Step 1: Data Settings ------------------------------------------------------------------
# Install, load, set the necessary packages, directories and functions
library(readxl)
# Load if using RStudio (interactive session)
library(rstudioapi)
# Managing datasets
library(dplyr)
# Load for excel manipulation
library(writexl)
# Get the path of the current script (works in RStudio)
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DataSettings.R"
function_path <- rstudioapi::getActiveDocumentContext()$path
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/"
functionfolder_path <- dirname(function_path)
# Set path to shared folder with the rawdata two directories up
datasetfolder_path <- paste0(dirname(dirname(functionfolder_path)),"/Datasets/")
# Allow to set and check working space for the github collaborator coding
setwd(functionfolder_path)
getwd()
dir()
# Set paths to datasets
presurvey_overview <- paste0(datasetfolder_path,"vjcortesa_Presurvey_questions overview.xlsx")
presurvey_settings <- read_excel(presurvey_overview, sheet = "dataset_240924")
presurvey_path <- paste0(datasetfolder_path,"housinggame_session_16_240924_surveys/241108_240924_WhereWeMove sessions - presurvey.xlsx")
# Step 1: Read the full sheet including metadata
raw_data <- read_excel(presurvey_path, col_names = FALSE)
# Step 2: Extract the actual headers from row 2
real_headers <- as.character(unlist(raw_data[2, ]))
# Step 3: Read the data again, skipping metadata rows (e.g., first 2 rows)
presurvey_data <- read_excel(presurvey_path, skip = 3, col_names = FALSE)
# Step 4: Assign the real headers
colnames(presurvey_data) <- real_headers
presurvey_settings_rp <- presurvey_settings %>%
filter(!is.na(DataAnalysisQuestion) & DataAnalysisQuestion != 0)
rp_settings <- list()
# Initialize an empty data frame to collect metadata
question_metadata <- data.frame(
uid = integer(),
DataAnalysisQuestion = character(),
QuestionAlias = character(),
QuestionText = character(),
QuestionColumn = integer(),
AnswerOptions = character(),
stringsAsFactors = FALSE
)
# Loop through each row
for (i in 1:nrow(presurvey_settings_rp)) {
# Extract values from the row
row_metadata <- data.frame(
uid = i,
DataAnalysisQuestion = as.character(presurvey_settings_rp[i, "DataAnalysisQuestion"]),
QuestionAlias = as.character(presurvey_settings_rp[i, "QuestionAlias"]),
QuestionText = as.character(presurvey_settings_rp[i, "QuestionText"]),
QuestionColumn = as.integer(presurvey_settings_rp[i, "QuestionColumn"]),
AnswerOptions = as.character(presurvey_settings_rp[i, "AnswerOptions"]),
stringsAsFactors = FALSE
)
# Append the row to the metadata data frame
question_metadata <- rbind(question_metadata, row_metadata)
}
# Store the metadata data frame under the key
rp_settings[["survey_metadata"]] <- question_metadata
View(presurvey_settings_rp)
# Store the metadata data frame under the key
rp_settings[["survey_metadata"]] <- question_metadata
# Loop through each row starting from column 5, where the RP categorical questions start
for (i in 5:nrow(presurvey_settings_rp)) {
# Get the name from the second column
var_name <- as.character(presurvey_settings_rp[i, 2])
# Initialize vectors to collect codes and labels
codes <- c()
labels <- c()
# Loop over each column in the row starting from column 6 where the questions option starts (excluding the first column)
for (j in 6:ncol(presurvey_settings_rp)) {
cell_value <- presurvey_settings_rp[i, j]
# Check if the cell is not NA and not an empty string
if (!is.na(cell_value) && cell_value != "") {
# Split by '='
split_value <- strsplit(as.character(cell_value), "=")[[1]]
# Trim whitespace
split_value <- trimws(split_value)
# Assign code and label
if (length(split_value) == 2) {
codes <- c(codes, split_value[1])
labels <- c(labels, split_value[2])
} else {
# If no '=', treat entire value as label with NA code
codes <- c(codes, NA)
labels <- c(labels, split_value[1])
}
}
}
# Loop through each row starting from column 5, where the RP categorical questions start
for (i in 5:nrow(presurvey_settings_rp)) {
# Get the name from the second column
var_name <- as.character(presurvey_settings_rp[i, 2])
# Initialize vectors to collect codes and labels
codes <- c()
labels <- c()
# Loop over each column in the row starting from column 6 where the questions option starts (excluding the first column)
for (j in 6:ncol(presurvey_settings_rp)) {
cell_value <- presurvey_settings_rp[i, j]
# Check if the cell is not NA and not an empty string
if (!is.na(cell_value) && cell_value != "") {
# Split by '='
split_value <- strsplit(as.character(cell_value), "=")[[1]]
# Trim whitespace
split_value <- trimws(split_value)
# Assign code and label
if (length(split_value) == 2) {
codes <- c(codes, split_value[1])
labels <- c(labels, split_value[2])
} else {
# If no '=', treat entire value as label with NA code
codes <- c(codes, NA)
labels <- c(labels, split_value[1])
}
}
}
# Create data frame with code and label columns
new_df <- data.frame(code = codes, label = labels, stringsAsFactors = FALSE)
# Store the df in the named list
rp_settings[[var_name]] <- new_df
}
# Initialize an empty list to collect columns
results_list <- list()
df <- rp_settings[["survey_metadata"]]
# Loop through each row in the settings to extract the corresponding columns from the results
for (i in 1:nrow(df)) {
var_name <- as.character(df[i, 3])  # QuestionAlias
col_number <- as.integer(df[i, 5])  # QuestionColumn
# Extract the column from the survey data
column_data <- presurvey_data[[col_number]]
# Store the column in the list with the correct name
results_list[[var_name]] <- column_data
riskperception_results <- as.data.frame(results_list, stringsAsFactors = FALSE)
}
original_columns <- colnames(riskperception_results)[5:ncol(riskperception_results)]
for (column_name in original_columns) {
if (!is.null(rp_settings[[column_name]])) {
labels <- rp_settings[[column_name]]$label
codes <- rp_settings[[column_name]]$code
matched_codes <- codes[match(riskperception_results[[column_name]], labels)]
new_col_name <- paste0(column_name, "code")
col_index <- which(colnames(riskperception_results) == column_name)
# Insert safely: if it's the last column, just append
if (col_index == ncol(riskperception_results)) {
riskperception_results[[new_col_name]] <- matched_codes
} else {
before <- riskperception_results[1:col_index]
after <- riskperception_results[(col_index + 1):ncol(riskperception_results)]
riskperception_results <- cbind(before, setNames(data.frame(matched_codes), new_col_name), after)
}
}
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GS4_vjcortesa_Risk profiles_incl_ownership.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GS4_vjcortesa_Risk profiles_incl_ownership.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GS4_vjcortesa_Risk profiles_incl_ownership.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DS_function.R")
source("~/TUDelft/18_Game Data Analysis/R data analysis BEPs/Scripts_vjcortesa/GS4_vjcortesa_Risk profiles_incl_ownership.R")
rp_240924 = riskperception_ds(presurvey_overview, presurvey_file_240924,"dataset_240924")
rp_250923 = riskperception_ds(presurvey_overview, presurvey_file_250923,"dataset_250923")
rp_251007 = riskperception_ds(presurvey_overview, presurvey_file_251007,"dataset_251007")
# Step 1: Data Settings ------------------------------------------------------------------
# Install, load, set the necessary packages, directories and functions
library(readxl)
# Load if using RStudio (interactive session)
library(rstudioapi)
# Managing datasets
library(dplyr)
# Load for excel manipulation
library(writexl)
# Get the path of the current script (works in RStudio)
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/vjcortesa_RiskPerception_DataSettings.R"
function_path <- rstudioapi::getActiveDocumentContext()$path
# e.g. "~/R data analysis BEPs/Scripts_vjcortesa/functions/"
functionfolder_path <- dirname(function_path)
# Set path to shared folder with the rawdata two directories up
datasetfolder_path <- paste0(dirname(dirname(functionfolder_path)),"/Datasets/")
# Allow to set and check working space for the github collaborator coding
setwd(functionfolder_path)
getwd()
dir()
# Set paths to datasets
presurvey_overview <- paste0(datasetfolder_path,"vjcortesa_Presurvey_questions overview.xlsx")
presurvey_settings <- read_excel(presurvey_overview, sheet = "dataset_240924")
presurvey_path <- paste0(datasetfolder_path,"housinggame_session_16_240924_surveys/241108_240924_WhereWeMove sessions - presurvey.xlsx")
# Step 1: Read the full sheet including metadata
raw_data <- read_excel(presurvey_path, col_names = FALSE)
# Step 2: Extract the actual headers from row 2
real_headers <- as.character(unlist(raw_data[2, ]))
# Step 3: Read the data again, skipping metadata rows (e.g., first 2 rows)
presurvey_data <- read_excel(presurvey_path, skip = 3, col_names = FALSE)
# Step 4: Assign the real headers
colnames(presurvey_data) <- real_headers
presurvey_settings_rp <- presurvey_settings %>%
filter(!is.na(DataAnalysisQuestion) & DataAnalysisQuestion != 0)
>>>>>>> ca769c527e0b91e58914c5a922abfb19a7b9f934
